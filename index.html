<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­ã©ã‚‚ã‚µãƒãƒ¼ãƒˆãƒ»ãƒŠãƒ“</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --mi-color: #ff7f7f; --ki-color: #ffb347; --ka-color: #76ba1b; --to-color: #4db8ff;
            --bg-color: #fcf9f5; --text: #4a4a4a;
        }
        body { font-family: 'Zen Maru Gothic', sans-serif; background-color: var(--bg-color); color: var(--text); margin: 0; padding: 15px; line-height: 1.8; }
        .container { max-width: 600px; width: 100%; margin: 20px auto; background: white; padding: 25px; border-radius: 30px; box-shadow: 0 15px 35px rgba(220, 180, 150, 0.15); border: 1px solid rgba(0,0,0,0.03); box-sizing: border-box;}
        .header h1 { font-size: 1.8rem; color: #d48344; margin: 10px 0; text-align: center; }
        
        .no-box { background: #fff; border: 2px solid #f9e2c4; border-radius: 20px; padding: 15px; margin-bottom: 20px; text-align: center; }
        .intro-box { background: #fffcf5; border-radius: 20px; padding: 20px; font-size: 0.9rem; border: 1px solid #f9e2c4; margin-bottom: 25px; }

        .tab-menu { display: flex; gap: 8px; margin-bottom: 25px; overflow-x: auto; padding-bottom: 5px; }
        .tab-btn { flex: 1; min-width: 80px; padding: 12px 5px; border: none; border-radius: 16px; cursor: pointer; font-weight: bold; background: #f0f0f0; transition: all 0.2s ease; font-family: inherit; font-size: 0.85rem; color: #999; }
        .tab-btn.active { color: white; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .tab-btn[data-tab="mi"].active { background: var(--mi-color); }
        .tab-btn[data-tab="kishitsu"].active { background: var(--ki-color); }
        .tab-btn[data-tab="kankyo"].active { background: var(--ka-color); }
        .tab-btn[data-tab="total"].active { background: var(--to-color); }

        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .q-block { margin-bottom: 20px; padding: 20px; border-radius: 20px; background: #fff; border: 1px solid #f0f0f0; }
        .q-text { font-weight: bold; font-size: 1rem; margin-bottom: 18px; display: block; color: #333; }
        .radio-group { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        .radio-label { text-align: center; font-size: 0.65rem; cursor: pointer; padding: 8px 4px; border-radius: 12px; border: 1px solid #eee; background: #fafafa; }
        .radio-label input { width: 20px; height: 20px; margin-bottom: 5px; }
        
        .btn { width: 100%; padding: 18px; color: white; border: none; border-radius: 50px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 15px; box-shadow: 0 6px 15px rgba(0,0,0,0.1); }
        
        .res-area { margin-top: 25px; padding: 25px; border-radius: 25px; display: none; background: #fff; border-top: 12px solid; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .res-area h3 { margin-top: 0; color: #333; }
        .detail-card { background: #fefefe; padding: 15px; border-radius: 15px; border-left: 5px solid #eee; margin: 10px 0; font-size: 0.95rem; }

        /* ç”»åƒæ›¸ãå‡ºã—ç”¨ã‚¨ãƒªã‚¢ (16:9) */
        #capture-container { 
            width: 1280px; height: 720px; 
            background: #fff; position: absolute; left: -9999px; 
            padding: 40px; box-sizing: border-box; display: flex; gap: 30px;
            font-family: 'Zen Maru Gothic', sans-serif;
        }
        .cap-left { flex: 1; display: flex; flex-direction: column; gap: 20px; }
        .cap-right { flex: 1; display: flex; flex-direction: column; gap: 20px; }
        .cap-box { border: 2px solid #eee; border-radius: 30px; padding: 30px; height: 100%; box-sizing: border-box; }
        .cap-title { font-size: 28px; font-weight: bold; margin-bottom: 20px; color: #d48344; border-bottom: 3px solid #f9e2c4; padding-bottom: 10px; }
        .cap-text { font-size: 18px; line-height: 1.8; }

        @media print { .tab-menu, .btn, .no-box, .q-block, .intro-box { display: none !important; } }
    </style>
</head>
<body>

<div class="container">
    <div class="header"><h1>ğŸŒ± å­ã©ã‚‚ã‚µãƒãƒ¼ãƒˆãƒ»ãƒŠãƒ“</h1></div>
    
    <div class="no-box">
        <strong style="color: #e67e22; font-size: 1rem; display: block; margin-bottom: 8px;">ğŸ›¡ï¸ å®‰å¿ƒã—ã¦ãŠä½¿ã„ã„ãŸã ããŸã‚ã«</strong>
        <div style="display: flex; justify-content: space-around; font-size: 0.75rem;">
            <span>âŒ è¨ºæ–­ã˜ã‚ƒãªã„</span><span>âŒ æ±ºã‚ã¤ã‘ãªã„</span><span>âŒ å›ºå®šã—ãªã„</span>
        </div>
    </div>

    <div class="intro-box">
        ğŸ•Šï¸ <strong>ã“ã®ãƒ„ãƒ¼ãƒ«ã®ç›®çš„</strong><br>
        ã€Œãªãœã€ã‚ã‚“ãªè¡Œå‹•ã‚’ã™ã‚‹ã‚“ã ã‚ã†ï¼Ÿã€ã¨ã„ã†æ—¥ã€…ã®ãƒ¢ãƒ¤ãƒ¢ãƒ¤ã‚’ã€ãŠå­ã•ã‚“ã¸ã®<strong>ã€Œç†è§£ã®ãƒ’ãƒ³ãƒˆã€</strong>ã«å¤‰ãˆã‚‹ãŸã‚ã®ã‚¬ã‚¤ãƒ‰ã§ã™ã€‚è¦ªå­ã§ç¬‘ã„åˆãˆã‚‹æ™‚é–“ã‚’å¢—ã‚„ã™ãŸã‚ã®ãŠå®ˆã‚Šã¨ã—ã¦ãŠä½¿ã„ãã ã•ã„ã€‚
    </div>

    <div class="tab-menu">
        <button class="tab-btn active" data-tab="mi">âœ¨å¼·ã¿</button>
        <button class="tab-btn" data-tab="kishitsu">ğŸŒˆæ°—è³ª</button>
        <button class="tab-btn" data-tab="kankyo">ğŸ ç’°å¢ƒ</button>
        <button class="tab-btn" data-tab="total" id="total-btn" disabled>ğŸ“Š ç·åˆ</button>
    </div>

    <div id="mi" class="tab-content active">
        <div id="mi-q"></div>
        <button class="btn" style="background:var(--mi-color)" onclick="calcMI()">ã€Œå¼·ã¿ã€ã®ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹ ğŸ”</button>
        <div id="chart-container"><canvas id="miChart"></canvas></div>
        <div id="mi-res" class="res-area" style="border-color:var(--mi-color)"></div>
    </div>

    <div id="kishitsu" class="tab-content">
        <div id="ki-q"></div>
        <button class="btn" style="background:var(--ki-color)" onclick="calcKi()">ã€Œæ°—è³ªã€ã®ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹ ğŸ”</button>
        <div id="ki-res" class="res-area" style="border-color:var(--ki-color)"></div>
    </div>

    <div id="kankyo" class="tab-content">
        <div id="ka-q"></div>
        <button class="btn" style="background:var(--ka-color)" onclick="calcKa()">ã€Œç’°å¢ƒã€ã®ãƒ’ãƒ³ãƒˆã‚’è¦‹ã‚‹ ğŸ”</button>
        <div id="ka-res" class="res-area" style="border-color:var(--ka-color)"></div>
    </div>

    <div id="total" class="tab-content">
        <div id="total-content"></div>
        <button class="btn" style="background:var(--to-color)" onclick="saveAsImage()">ğŸ“¸ ç”»åƒã¨ã—ã¦ä¿å­˜ã™ã‚‹</button>
        <button class="btn" style="background:#888; margin-top:10px;" onclick="window.print()">ğŸ–¨ï¸ çµæœã‚’å°åˆ·ã™ã‚‹</button>
    </div>
</div>

<div id="capture-container">
    <div class="cap-left">
        <div class="cap-box" style="background:#fffcf5;">
            <div class="cap-title">ğŸ¤ ãŠå­ã•ã‚“ã¸ã®ä¼´èµ°ã‚¬ã‚¤ãƒ‰</div>
            <div id="cap-summary" class="cap-text"></div>
        </div>
    </div>
    <div class="cap-right">
        <div class="cap-box" style="background:#fff5f5; border-color:#ff7f7f;">
            <div class="cap-title" style="color:#ff7f7f;">ğŸ’ ç¿»è¨³ã‚µãƒãƒ¼ãƒˆ</div>
            <div id="cap-translation" class="cap-text"></div>
        </div>
        <div class="cap-box" style="background:#f0f7ff; border-color:#4db8ff;">
            <div class="cap-title" style="color:#4db8ff;">ğŸ’Œ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</div>
            <div id="cap-message" class="cap-text"></div>
        </div>
    </div>
</div>

<script>
/* ğŸ“‹ ãƒ‡ãƒ¼ã‚¿å®šç¾© */
const miDetails = {
    "è¨€èª": {èƒ½åŠ›:"è¨€è‘‰ã‚’ç´¡ãã€æƒ³ã„ã‚’å½¢ã«ã™ã‚‹å¤©æ‰æ€§", éŠã³:"ã—ã‚Šã¨ã‚Šã€ãŠè©±ä½œã‚Šã€èª­ã¿èã‹ã›ã€è¨€è‘‰éŠã³", é–¢ã‚ã‚Š:"ã€Œãã‚“ãªè¨€è‘‰çŸ¥ã£ã¦ã‚‹ã®ï¼ã€ã€Œä»Šã®ä¾‹ãˆã€ã™ã”ãã‚ã‹ã‚Šã‚„ã™ã„ã­ã€ã¨ã€è¡¨ç¾ã®è±Šã‹ã•ã‚’å…·ä½“çš„ã«é¢ç™½ãŒã£ã¦ãã ã•ã„ã€‚", é ¼ã‚‹äºº:"ãŠå–‹ã‚Šã‚’æ¥½ã—ã‚“ã§ãã‚Œã‚‹ãŠã˜ã„ã¡ã‚ƒã‚“ã‚„ãŠã°ã‚ã¡ã‚ƒã‚“ã€å›³æ›¸é¤¨ã®å¸æ›¸ã•ã‚“"},
    "è«–ç†": {èƒ½åŠ›:"æ··æ²Œã‹ã‚‰æ³•å‰‡ã‚’è¦‹ã¤ã‘å‡ºã—ã€ç­‹é“ã‚’ç«‹ã¦ã‚‹åŠ›", éŠã³:"æ•°éŠã³ã€ãƒ‘ã‚ºãƒ«ã€ç§‘å­¦å®Ÿé¨“ã€ãƒ¬ã‚´ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", é–¢ã‚ã‚Š:"ã€Œãªãœã“ã†ãªã‚‹ã¨æ€ã†ï¼Ÿã€ã¨äºˆæ¸¬ã‚’ç«‹ã¦ã‚‹å•ã„ã‹ã‘ã‚’ã€‚çµè«–ã‚’æ€¥ã‹ã•ãšã€ãŠå­ã•ã‚“ã®é ­ã®ä¸­ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒå®Œæˆã™ã‚‹ã®ã‚’å¾…ã£ã¦ã‚ã’ã¾ã—ã‚‡ã†ã€‚", é ¼ã‚‹äºº:"å°†æ£‹ã‚„å›²ç¢ã‚’æ ¹æ°—ã‚ˆãä»˜ãåˆãˆã‚‹è¦ªæˆšã€ç†æ•°ç³»ãŒå¾—æ„ãªçŸ¥äºº"},
    "ç©ºé–“": {èƒ½åŠ›:"ä¸–ç•Œã‚’ç«‹ä½“çš„ã«æ‰ãˆã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å½¢ã«ã™ã‚‹åŠ›", éŠã³:"ãƒ–ãƒ­ãƒƒã‚¯ã€è¿·è·¯ã€ãŠçµµã‹ãã€å·¥ä½œã€ã‚­ãƒ£ãƒ³ãƒ—", é–¢ã‚ã‚Š:"è¨€è‘‰ã§é•·ã€…ã¨æŒ‡ç¤ºã›ãšã€å›³è§£ã‚„è¦‹æœ¬ã€ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼ã§è¦‹ã›ã‚‹ã¨é©šãã»ã©ã‚¹ãƒ ãƒ¼ã‚ºã«ç†è§£ãŒé€²ã¿ã¾ã™ã€‚", é ¼ã‚‹äºº:"DIYãŒå¾—æ„ãªå¤§äººã€å·¥ä½œãŒå¥½ããªå¹´ä¸Šã®å‹é”"},
    "èº«ä½“": {èƒ½åŠ›:"è‡ªåˆ†ã®ä½“ã¨å¯¾è©±ã—ã€å™¨ç”¨ã«ä½¿ã„ã“ãªã™åŠ›", éŠã³:"ãƒ€ãƒ³ã‚¹ã€ã‚¢ã‚¹ãƒ¬ãƒãƒƒã‚¯ã€ç²˜åœŸç´°å·¥ã€æ–™ç†", é–¢ã‚ã‚Š:"ã€Œã‚„ã£ã¦ã¿ã¦è¦šãˆã‚‹ã€ãŒä¸€ç•ªã®è¿‘é“ã€‚é™ã‹ã«åº§ã‚‰ã›ã‚‹ã‚ˆã‚Šã€å‹•ã‹ã—ãªãŒã‚‰å­¦ã¶ç’°å¢ƒã®æ–¹ãŒã€ã“ã®å­ã®æ‰èƒ½ã¯è¼ãã¾ã™ã€‚", é ¼ã‚‹äºº:"ä¸€ç·’ã«å…¬åœ’ã§èµ°ã‚Šå›ã‚Œã‚‹å…ƒæ°—ãªå”çˆ¶ã•ã‚“ã‚„ã‚¹ãƒãƒ¼ãƒ„æŒ‡å°è€…"},
    "éŸ³æ¥½": {èƒ½åŠ›:"éŸ³ã®æ©Ÿå¾®ã‚’æ„Ÿã˜å–ã‚Šã€ãƒªã‚ºãƒ ã§ä¸–ç•Œã‚’æ‰ãˆã‚‹åŠ›", éŠã³:"æ¥½å™¨ã€æ­Œã€ãƒªã‚ºãƒ ã‚²ãƒ¼ãƒ ã€è‡ªç„¶ã®éŸ³æ¢ã—", é–¢ã‚ã‚Š:"è¦šãˆãŸã„ãƒ«ãƒ¼ãƒ«ã‚„çŸ¥è­˜ã‚’ãƒ¡ãƒ­ãƒ‡ã‚£ã«ä¹—ã›ã‚‹ã¨ã€é­”æ³•ã®ã‚ˆã†ã«å¸åã—ã¾ã™ã€‚éŸ³ã®ãƒˆãƒ¼ãƒ³ã‹ã‚‰äººã®æ„Ÿæƒ…ã‚’å¯Ÿã™ã‚‹åŠ›ã‚‚é«˜ã„ã§ã™ã€‚", é ¼ã‚‹äºº:"éŸ³æ¥½å¥½ããªãŠæ¯ã•ã‚“ã€é¼»æ­Œã‚’ä¸€ç·’ã«æ¥½ã—ã‚ã‚‹ãŠã°ã‚ã¡ã‚ƒã‚“"},
    "å¯¾äºº": {èƒ½åŠ›:"äººã®å¿ƒã«æ©‹ã‚’ã‹ã‘ã€èª¿å’Œã‚’ç”Ÿã¿å‡ºã™åŠ›", éŠã³:"ã”ã£ã“éŠã³ã€ãƒãƒ¼ãƒ ã‚¹ãƒãƒ¼ãƒ„ã€ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ", é–¢ã‚ã‚Š:"ã€Œã€‡ã€‡ãã‚“ãŒå–œã‚“ã§ãã‚ŒãŸã­ã€ã¨ã„ã†å®Ÿæ„Ÿã‚’å…±æœ‰ã™ã‚‹ã¨ã€ã‚„ã‚‹æ°—ãŒä½•å€ã«ã‚‚è†¨ã‚‰ã¿ã¾ã™ã€‚äººã®å½¹ã«ç«‹ã¤å®Ÿæ„ŸãŒã‚¬ã‚½ãƒªãƒ³ã«ãªã‚Šã¾ã™ã€‚", é ¼ã‚‹äºº:"ã„ã¤ã‚‚å„ªã—ãè©±ã‚’è´ã„ã¦ãã‚Œã‚‹è¿‘æ‰€ã®äººã€ç¤¾äº¤çš„ãªå‹äºº"},
    "å†…çœ": {èƒ½åŠ›:"è‡ªåˆ†è‡ªèº«ã‚’æ·±ãè¦‹ã¤ã‚ã€æŠ˜ã‚Œãªã„èŠ¯ã‚’ä½œã‚‹åŠ›", éŠã³:"æ—¥è¨˜ã€ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€ä¸€äººã§æ²¡é ­ã§ãã‚‹è¶£å‘³", é–¢ã‚ã‚Š:"ç„¡ç†ã«ç¾¤ã‚Œã•ã›ã‚ˆã†ã¨ã›ãšã€ä¸€äººã®æ™‚é–“ã‚’ã€Œå……é›»æ™‚é–“ã€ã¨ã—ã¦å°Šé‡ã—ã¦ãã ã•ã„ã€‚è‡ªåˆ†ã§ç´å¾—ã—ã¦æ±ºã‚ãŸã“ã¨ã¯æœ€å¾Œã¾ã§ã‚„ã‚ŠæŠœãã¾ã™ã€‚", é ¼ã‚‹äºº:"å£å‡ºã—ã›ãšé™ã‹ã«è¦‹å®ˆã£ã¦ãã‚Œã‚‹ç©ã‚„ã‹ãªå¤§äºº"},
    "åšç‰©": {èƒ½åŠ›:"ä¸–ç•Œã®ç´°ã‹ãªé•ã„ã‚’è¦‹æ¥µã‚ã€åˆ†é¡ã™ã‚‹æ¢ç©¶å¿ƒ", éŠã³:"å›³é‘‘ä½œã‚Šã€è™«æ•ã‚Šã€ç‰¹å®šã®ãƒ†ãƒ¼ãƒã®åé›†ã€çŸ³æ‹¾ã„", é–¢ã‚ã‚Š:"å¤§äººã‹ã‚‰è¦‹ã‚Œã°ã€Œäº›ç´°ãªé•ã„ã€ã¸ã®ã“ã ã‚ã‚Šã‚’ã€ã€Œé¢ç™½ã„è¦–ç‚¹ã ã­ï¼ã€ã¨é¢ç™½ãŒã£ã¦ã€‚ãã®è¦³å¯ŸåŠ›ãŒå°†æ¥ã®å¤§ããªåŠ›ã«ãªã‚Šã¾ã™ã€‚", é ¼ã‚‹äºº:"ã“ã ã‚ã‚Šã‚’ã€Œã™ã”ã„ï¼ã€ã¨é¢ç™½ãŒã£ã¦ãã‚Œã‚‹ã‚ªã‚¿ã‚¯æ°—è³ªãªå¤§äºº"}
};

const kiDetails = {
    "ãƒ‡ãƒªã‚±ãƒ¼ãƒˆ": {å›°ã‚Š:"æ–°ã—ã„ç’°å¢ƒã§å›ºã¾ã‚‹ã€å¤‰åŒ–ã‚’å«Œã†", ç¿»è¨³:"ã€Œå®‰å…¨ã‹ã©ã†ã‹ã€ã‚’èª°ã‚ˆã‚Šã‚‚æ…é‡ã«ç¢ºèªã—ã¦ã„ã‚‹è±Šã‹ãªæ„Ÿå—æ€§", å¯¾å¿œ:"ã€Œæ€–ã„ã‚ˆã­ã€è¦‹ã¦ã‚‹ã‹ã‚‰å¤§ä¸ˆå¤«ã€ã¨ã€äºˆå‘Šï¼ˆè¦‹é€šã—ï¼‰ã¨å®‰å¿ƒæ„Ÿã‚’ã‚»ãƒƒãƒˆã§ä¼ãˆã¦ã€‚ã“ã®å­ã®ã€Œæ…é‡ã•ã€ã¯ã€å°†æ¥ã®ã€Œå±æ©Ÿç®¡ç†èƒ½åŠ›ã€ã‚„ã€Œå…±æ„ŸåŠ›ã€ã®æºã§ã™ã€‚"},
    "ã‚¢ã‚¯ãƒ†ã‚£ãƒ–": {å›°ã‚Š:"è¡å‹•çš„ã«é£›ã³å‡ºã™ã€è©±ã‚’èã‹ãšã«å‹•ã", ç¿»è¨³:"ã€Œæº¢ã‚Œã‚‹å¥½å¥‡å¿ƒã€ã¨ã€ä¸–ç•Œã‚’çŸ¥ã‚ŠãŸã„ã¨ã„ã†çˆ†ç™ºçš„ãªç”Ÿå‘½åŠ›", å¯¾å¿œ:"å±ã‚‹å›æ•°ã‚’æ¸›ã‚‰ã™ãŸã‚ã€ç‰©ç†çš„ãªã€Œæ­¢ã¾ã‚‹å ´æ‰€ã€ã‚’ç´„æŸã€‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ç™ºæ•£å…ˆã‚’ç¢ºä¿ã—ã¦ã‚ã’ã‚‹ã¨ã€ç´ æ™´ã‚‰ã—ã„ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã—ã¾ã™ã€‚"},
    "ã‚¨ãƒ³ã‚¸ã‚§ãƒ«": {å›°ã‚Š:"è‡ªåˆ†ã®æ„è¦‹ã‚’è¨€ã‚ãªã„ã€å‘¨ã‚Šã«åˆã‚ã›ã™ãã‚‹", ç¿»è¨³:"ã€Œå ´ã®å¹³å’Œã€ã‚’å®ˆã‚‹ã“ã¨ã‚’æœ¬èƒ½çš„ã«å„ªå…ˆã§ãã‚‹ã€ç¨€æœ‰ãªå„ªã—ã•", å¯¾å¿œ:"ã€Œã‚ãªãŸã¯ã©ã†ã—ãŸã„ï¼Ÿã€ã¨ã€æœ¬éŸ³ã‚’æ‹¾ã†æ™‚é–“ã‚’å€‹åˆ¥ã«ã€‚ç„¡ç†ã—ã¦åˆã‚ã›ã¦ã„ã‚‹è‡ªåˆ†ã«æ°—ã¥ã„ã¦ã‚ã’ã‚‹ã“ã¨ãŒã€ã“ã®å­ã®è‡ªå°Šå¿ƒã‚’å®ˆã‚Šã¾ã™ã€‚"},
    "ãƒ†ã‚­ã‚¹ãƒˆ": {å›°ã‚Š:"äºˆå®šå¤‰æ›´ã§ãƒ‘ãƒ‹ãƒƒã‚¯ã€æ‰‹é †ã¸ã®ã“ã ã‚ã‚Š", ç¿»è¨³:"ã€Œç§©åºã€ã¨ã€Œä¸€è²«æ€§ã€ã®ä¸­ã«å®‰å¿ƒã‚’è¦‹å‡ºã™ã€é«˜ã„è«–ç†æ€è€ƒã®èŠ½", å¯¾å¿œ:"æ—©ã‚ã®äºˆå‘Šã‚’å¾¹åº•ã€‚è¨€è‘‰ã ã‘ã§ãªãçµµã‚„å†™çœŸã§ã€Œæ¬¡ã¯ã€‡ã€‡ã ã‚ˆã€ã¨è¦–è¦šçš„ã«ä¼ãˆã‚‹ã¨ã€ãƒ‘ãƒ‹ãƒƒã‚¯ã¯åŠ‡çš„ã«æ¸›ã‚Šã¾ã™ã€‚"},
    "ãƒã‚¬ãƒ†ã‚£ãƒ–": {å›°ã‚Š:"æ¿€ã—ã„ã‚¤ãƒ¤ã‚¤ãƒ¤ã€ç´å¾—ã—ãªã„ã¨å‹•ã‹ãªã„", ç¿»è¨³:"ã€Œè‡ªåˆ†ã®é¡˜ã„ã€ã‚’å¦¥å”ã›ãšã€è‡ªåˆ†ã‚’è²«ã“ã†ã¨ã™ã‚‹å¼·ã„ç²¾ç¥çš„è‡ªç«‹å¿ƒ", å¯¾å¿œ:"ä¸€åº¦ã€Œæ‚”ã—ã„ã­ã€ã€Œã“ã‚ŒãŒå«Œã ã£ãŸã‚“ã ã­ã€ã¨æ„Ÿæƒ…ã‚’100%å—ã‘æ­¢ã‚ã¦ã‹ã‚‰ã€‚å¦å®šã•ã‚Œã‚‹ã¨ç«ãŒã¤ãã¾ã™ãŒã€å…±æ„Ÿã•ã‚Œã‚‹ã¨é©šãã»ã©è½ã¡ç€ãã¾ã™ã€‚"}
};

const kaDetails = {
    "è¦–è¦šæ”¯æ´": {å›°ã‚Š:"è¨€è‘‰ã®æŒ‡ç¤ºãŒé€šã‚‰ãªã„", æ‰‹ç«‹ã¦:"ã€ç›®ã§è¦‹ã¦ã‚ã‹ã‚‹ã€‘çµµã‚«ãƒ¼ãƒ‰ã€å†™çœŸã€ã‚¿ã‚¤ãƒãƒ¼", è§£èª¬:"è€³ã‹ã‚‰ã®æƒ…å ±ã‚ˆã‚Šã‚‚ã€ç›®ã‹ã‚‰ã®æƒ…å ±ãŒåœ§å€’çš„ã«å¾—æ„ãªã‚¿ã‚¤ãƒ—ã€‚æŒ‡ç¤ºã‚’å‡ºã™ã¨ãã€ã¾ãšã¯ã€Œã“ã‚Œã‚’è¦‹ã¦ã€ã¨ãŠå­ã•ã‚“ã®ç›®ã‚’è¦–è¦šæƒ…å ±ã«å‘ã‘ã•ã›ã‚‹ã“ã¨ãŒæœ€å¤§ã®ã‚³ãƒ„ã§ã™ã€‚"},
    "è´è¦šé…æ…®": {å›°ã‚Š:"é¨’ãŒã—ã„ã¨æ··ä¹±ã™ã‚‹", æ‰‹ç«‹ã¦:"ã€è€³ã®è² æ‹…æ¸›ã€‘ã‚¤ãƒ¤ãƒ¼ãƒãƒ•ã€é™ã‹ãªé¿é›£å ´æ‰€", è§£èª¬:"å‘¨å›²ã®é›‘éŸ³ãŒã€Œçˆ†éŸ³ã€ã®ã‚ˆã†ã«èã“ãˆã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚é™ã‹ãªç©ºé–“ã‚’ç”¨æ„ã™ã‚‹ã“ã¨ã¯ã€ã“ã®å­ã«ã¨ã£ã¦ã€Œé…¸ç´ ã€ã‚’è£œçµ¦ã™ã‚‹ã®ã¨åŒã˜ãã‚‰ã„å¤§åˆ‡ãªã“ã¨ã§ã™ã€‚"},
    "æ§‹é€ åŒ–": {å›°ã‚Š:"ç‰‡ä»˜ã‘ãŒã§ããªã„ã€ä½•ã‹ã‚‰ã—ã¦ã„ã„ã‹ä¸æ˜", æ‰‹ç«‹ã¦:"ã€ç‰©ã®ä½æ‰€ã‚’æ±ºã‚ã‚‹ã€‘ãƒ©ãƒ™ãƒ«ã€æ‰‹é †ã®123", è§£èª¬:"ã€Œç‰‡ä»˜ã‘ãªã•ã„ã€ã¨ã„ã†æ›–æ˜§ãªè¨€è‘‰ãŒè‹¦æ‰‹ã€‚ç®±ã«ã€ŒãƒŸãƒ‹ã‚«ãƒ¼ã€ã¨å†™çœŸã‚’è²¼ã‚‹ã ã‘ã§ã€ãŠå­ã•ã‚“ã®è„³ã¯ã€Œã©ã“ã«ä½•ã‚’ã™ã¹ãã‹ã€ã‚’è‡ªå‹•çš„ã«å‡¦ç†ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚"},
    "æ„Ÿè¦šçµ±åˆ": {å›°ã‚Š:"è½ã¡ç€ããŒãªã„ã€ç‰¹å®šã®æ„Ÿè§¦ã‚’å«Œã†", æ‰‹ç«‹ã¦:"ã€æ„Ÿè¦šã®è£œå®Œã€‘æŠ±ã£ã“ã€å›è»¢éŠã³", è§£èª¬:"è„³ãŒã€Œåˆºæ¿€ã€ã‚’æ±‚ã‚ã¦ã„ã‚‹ã‹ã€é€†ã«ã€Œåˆºæ¿€ã€ã«æ€¯ãˆã¦ã„ã‚‹çŠ¶æ…‹ã€‚ãã‚…ã£ã¨æŠ±ãã—ã‚ã‚‹ã€Œåœ§åˆºæ¿€ã€ã‚„ã€ãƒ–ãƒ©ãƒ³ã‚³ãªã©ã®ã€Œæºã‚Œã€ãŒã€è„³ã‚’å®‰å®šã•ã›ã‚‹ãŠè–¬ã«ãªã‚Šã¾ã™ã€‚"},
    "å®Ÿè¡Œæ©Ÿèƒ½": {å›°ã‚Š:"åˆ‡ã‚Šæ›¿ãˆå›°é›£ã€å¿˜ã‚Œç‰©ãŒå¤šã„", æ‰‹ç«‹ã¦:"ã€å¤–ä»˜ã‘å¸ä»¤å¡”ã€‘ãƒªã‚¹ãƒˆã€ã‚¢ãƒ©ãƒ¼ãƒ ", è§£èª¬:"ã€Œæ¬¡ã«ä½•ã‚’ã™ã¹ãã‹ã€ã‚’ç®¡ç†ã™ã‚‹è„³ã®ã‚¨ãƒªã‚¢ãŒã¾ã æˆé•·é€”ä¸­ã€‚è¦ªãŒã€Œå¤–ä»˜ã‘ã®å¸ä»¤å¡”ã€ã¨ã—ã¦ã€ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚„ã‚¢ãƒ©ãƒ¼ãƒ ã‚’ç”¨æ„ã—ã¦ã‚ã’ã‚‹ã“ã¨ã§ã€æˆåŠŸä½“é¨“ã‚’ç©ã¾ã›ã¦ã‚ã’ã¾ã—ã‚‡ã†ã€‚"}
};

/* ãƒ­ã‚¸ãƒƒã‚¯éƒ¨åˆ†ã¯ç°¡ç•¥åŒ–ã—ã¤ã¤ç²¾åº¦ç¶­æŒ */
const miData = [{c:"è¨€èª", q:"ğŸ“š è¨€è‘‰ã®éŸ¿ãã‚’æ¥½ã—ã‚“ã ã‚Šã€ç‰©èªã‚’ä½œã£ã¦è©±ã™ã®ãŒå¥½ã"},{c:"è¨€èª", q:"ğŸ“– çµµæœ¬ã®èª­ã¿èã‹ã›ã‚’å¥½ã¿ã€è¨€è‘‰ã®æ„å‘³ã‚’ã‚ˆãè³ªå•ã™ã‚‹"},{c:"è«–ç†", q:"ğŸ§© ãƒ‘ã‚ºãƒ«ã‚„æ•°å­—ã®ä¸¦ã³ã€ç‰©äº‹ã®æ³•å‰‡ã‚’è¦‹ã¤ã‘ã‚‹ã®ãŒå¾—æ„"},{c:"è«–ç†", q:"ğŸ” ã€Œã©ã†ã—ã¦ã“ã†ãªã‚‹ã®ï¼Ÿã€ã¨ä»•çµ„ã¿ã‚’æ·±ãçŸ¥ã‚ŠãŸãŒã‚‹"},{c:"ç©ºé–“", q:"ğŸ—ºï¸ åˆã‚ã¦ã®é“ã‚„å»ºç‰©ã®æ§‹é€ ã‚’ã€é ­ã®ä¸­ã§æ‰ãˆã‚‹ã®ãŒä¸Šæ‰‹"},{c:"ç©ºé–“", q:"ğŸ° ãƒ–ãƒ­ãƒƒã‚¯ã‚„å·¥ä½œã§ã€ç«‹ä½“çš„ãªä½œå“ã‚’ä½œã‚‹ã®ãŒå¥½ã"},{c:"èº«ä½“", q:"ğŸƒâ€â™‚ï¸ ãƒ€ãƒ³ã‚¹ã‚„é‹å‹•ãªã©ã€ä½“ã‚’æ€ã„é€šã‚Šã«å‹•ã‹ã™ã®ãŒå¾—æ„"},{c:"èº«ä½“", q:"âœ‚ï¸ æŠ˜ã‚Šç´™ã‚„æ–™ç†ãªã©ã€æ‰‹å…ˆã‚’ä½¿ã£ãŸç´°ã‹ã„ä½œæ¥­ãŒå¾—æ„"},{c:"éŸ³æ¥½", q:"ğŸ¶ é¼»æ­Œã‚„ãƒªã‚ºãƒ ä¹—ã‚ŠãŒè‰¯ãã€ãƒ¡ãƒ­ãƒ‡ã‚£ã‚’è¦šãˆã‚‹ã®ãŒæ—©ã„"},{c:"éŸ³æ¥½", q:"ğŸ¹ å‘¨å›²ã®éŸ³ã‚„äººã®å£°ã®ãƒˆãƒ¼ãƒ³ã«æ•æ„Ÿã«åå¿œã™ã‚‹"},{c:"å¯¾äºº", q:"ğŸ¤ å‹é”ãŒå›°ã£ã¦ã„ã‚‹ã¨ã™ãã«æ°—ã¥ã„ã¦å£°ã‚’ã‹ã‘ã‚‰ã‚Œã‚‹"},{c:"å¯¾äºº", q:"ğŸ« ä¸€äººã‚ˆã‚Šã€ã¿ã‚“ãªã§å”åŠ›ã—ã¦ä½•ã‹ã‚’ã™ã‚‹ã®ãŒå¥½ã"},{c:"å†…çœ", q:"ğŸ§˜ è‡ªåˆ†ã®è€ƒãˆã‚’ã—ã£ã‹ã‚ŠæŒã¡ã€ä¸€äººã§é™ã‹ã«éã”ã™æ™‚é–“ã‚’å¥½ã‚€"},{c:"å†…çœ", q:"ğŸ’­ ã€Œè‡ªåˆ†ã¯ã“ã†ã—ãŸã„ã€ã¨ã„ã†æ„å¿—ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹"},{c:"åšç‰©", q:"ğŸ¦– æç«œã€æ¤ç‰©ã€ä¹—ã‚Šç‰©ãªã©ã€å¥½ããªã‚‚ã®ã‚’åé›†ãƒ»è¦³å¯Ÿã™ã‚‹"}];
const kiData = [{t:"ãƒ‡ãƒªã‚±ãƒ¼ãƒˆ", q:"ğŸ‘€ æœã®ã‚¿ã‚°ã‚„å…‰ã€å°ã•ãªç‰©éŸ³ã«ã™ãæ°—ã¥ã„ã¦å«ŒãŒã‚‹"},{t:"ãƒ‡ãƒªã‚±ãƒ¼ãƒˆ", q:"ğŸ˜Ÿ å¤±æ•—ã™ã‚‹ã“ã¨ã‚’æ€–ãŒã‚Šã€è‡ªä¿¡ãŒãªã„ã¨æŒ‘æˆ¦ã‚’é¿ã‘ã‚‹"},{t:"ãƒ‡ãƒªã‚±ãƒ¼ãƒˆ", q:"ğŸŒ³ åˆã‚ã¦ã®å ´æ‰€ã‚„æ…£ã‚Œãªã„äººã®å‰ã§ã¯ã€å›ºã¾ã£ãŸã‚Šæ…é‡ã«ãªã‚‹"},{t:"ãƒ‡ãƒªã‚±ãƒ¼ãƒˆ", q:"ğŸ’§ èª°ã‹ãŒæ€’ã‚‰ã‚Œã¦ã„ã‚‹ã®ã‚’è¦‹ã‚‹ã¨è‡ªåˆ†ã‚‚æ‚²ã—ããªã‚‹"},{t:"ã‚¢ã‚¯ãƒ†ã‚£ãƒ–", q:"ğŸš€ ã˜ã£ã¨ã—ã¦ã„ã‚‹ã‚ˆã‚Šå¸¸ã«å‹•ã„ã¦ã„ã‚‹æ–¹ãŒè‡ªç„¶"},{t:"ã‚¢ã‚¯ãƒ†ã‚£ãƒ–", q:"ğŸ”¥ å±ãªã„ã¨è¨€ã‚ã‚Œã¦ã‚‚å¥½å¥‡å¿ƒãŒå‹ã£ã¦é£›ã³å‡ºã™"},{t:"ã‚¢ã‚¯ãƒ†ã‚£ãƒ–", q:"ğŸ“£ è‡ªåˆ†ã®ã‚„ã‚ŠãŸã„ã“ã¨ã‚’åŠ›å¼·ãä¸»å¼µã™ã‚‹"},{t:"ã‚¢ã‚¯ãƒ†ã‚£ãƒ–", q:"ğŸƒâ€â™‚ï¸ èˆˆå‘³ã®ã‚ã‚‹ã‚‚ã®ã‚’è¦‹ã¤ã‘ã‚‹ã¨å‘¨ã‚Šã‚’è¦‹ãšã«é§†ã‘å¯„ã‚‹"},{t:"ã‚¨ãƒ³ã‚¸ã‚§ãƒ«", q:"ğŸŒ¸ äº‰ã„ã‚’å«Œã„ã€ãŠã‚‚ã¡ã‚ƒã‚’è­²ã£ã¦ã‚ã’ã‚‰ã‚Œã‚‹"},{t:"ã‚¨ãƒ³ã‚¸ã‚§ãƒ«", q:"ğŸ¤ å‘¨ã‚Šã®é›°å›²æ°—ã‚’æ˜ã‚‹ãã—ã€ä»²è‰¯ãéã”ãã†ã¨ã™ã‚‹"},{t:"ã‚¨ãƒ³ã‚¸ã‚§ãƒ«", q:"ğŸ•Šï¸ åŸºæœ¬çš„ã«ç©ã‚„ã‹ã§ã€ãƒ‹ã‚³ãƒ‹ã‚³ã—ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„"},{t:"ã‚¨ãƒ³ã‚¸ã‚§ãƒ«", q:"ğŸ‚ è‡ªåˆ†ã®æ°—æŒã¡ã‚’æŠ‘ãˆã¦ã§ã‚‚å‘¨ã‚Šã«åˆã‚ã›ã‚ˆã†ã¨ã™ã‚‹"},{t:"ãƒ†ã‚­ã‚¹ãƒˆ", q:"â° æ¯æ—¥ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ãŒæ±ºã¾ã£ã¦ã„ãªã„ã¨ä¸å®‰"},{t:"ãƒ†ã‚­ã‚¹ãƒˆ", q:"ğŸ“‰ ã€Œã‚ã¨5åˆ†ã€ã‚„ã€Œ3ã¤ã€ãªã©å…·ä½“çš„ãªæ•°å­—ãŒå®‰å¿ƒ"},{t:"ãƒ†ã‚­ã‚¹ãƒˆ", q:"ğŸ“¦ ç‰©ã®ç½®ãå ´æ‰€ã‚„ãƒ«ãƒ¼ãƒ«ã«ã“ã ã‚ã‚ŠãŒã‚ã‚‹"},{t:"ãƒ†ã‚­ã‚¹ãƒˆ", q:"ğŸ“– å›³é‘‘ã€æ¨™è­˜ã€æ•°å­—ãªã©è¦å‰‡æ€§ã®ã‚ã‚‹ã‚‚ã®ã‚’å¥½ã‚€"},{t:"ãƒã‚¬ãƒ†ã‚£ãƒ–", q:"âš¡ æ„Ÿæƒ…ã®çˆ†ç™ºãŒæ¿€ã—ãã€åˆ‡ã‚Šæ›¿ãˆã«æ™‚é–“ãŒã‹ã‹ã‚‹"},{t:"ãƒã‚¬ãƒ†ã‚£ãƒ–", q:"ğŸ’ è‡ªåˆ†ãŒç´å¾—ã§ããªã„ã¨çµ¶å¯¾ã«å‹•ã‹ãªã„å¼·ã„æ„å¿—"},{t:"ãƒã‚¬ãƒ†ã‚£ãƒ–", q:"ğŸ˜¤ ã€Œè‡ªåˆ†ã ã‘ã®ãƒ«ãƒ¼ãƒ«ã€ã‚’é‚ªé­”ã•ã‚Œã‚‹ã¨æ¿€ã—ãæ€’ã‚‹"},{t:"ãƒã‚¬ãƒ†ã‚£ãƒ–", q:"ğŸŒªï¸ å¼·ã„ã“ã ã‚ã‚ŠãŒã‚ã‚Šã€æ€ã„é€šã‚Šã«ãªã‚‰ãªã„ã¨ãƒ‘ãƒ‹ãƒƒã‚¯ã«ãªã‚‹"}];
const kaData = [{t:"è¦–è¦šæ”¯æ´", q:"ğŸ“¢ è¨€è‘‰ã ã‘ã§è¨€ã‚ã‚Œã¦ã‚‚å¿˜ã‚Œã¦ã—ã¾ã†"},{t:"è¦–è¦šæ”¯æ´", q:"ğŸ–¼ï¸ å†™çœŸã‚„ã‚¤ãƒ©ã‚¹ãƒˆã®ã»ã†ãŒã™ãã«ç†è§£ã§ãã‚‹"},{t:"è¦–è¦šæ”¯æ´", q:"ğŸ“… äºˆå®šãŒè¦‹ãˆã¦ã„ã‚‹ã¨è‡ªåˆ†ã‹ã‚‰å‹•ã‘ã‚‹"},{t:"è´è¦šé…æ…®", q:"ğŸ‘‚ è³‘ã‚„ã‹ãªå ´æ‰€ã‚„ã‚¬ãƒ¤ã‚¬ãƒ¤ã—ãŸéŸ³ãŒè‹¦æ‰‹"},{t:"è´è¦šé…æ…®", q:"ğŸ§ é™ã‹ãªå ´æ‰€ã«è¡Œãã¨è½ç€ã"},{t:"æ§‹é€ åŒ–", q:"ğŸ§º ç‰‡ä»˜ã‘å ´æ‰€ãŒæ±ºã¾ã£ã¦ãªã„ã¨æ··ä¹±ã™ã‚‹"},{t:"æ§‹é€ åŒ–", q:"ğŸªœ ä½œæ¥­ã®æ‰‹é †ã‚’ç´°ã‹ãåˆ†ã‘ã¦ã»ã—ã„"},{t:"æ§‹é€ åŒ–", q:"ğŸ¤« è‡ªåˆ†ã ã‘ã®å›²ã‚ã‚ŒãŸç©ºé–“ã‚’å¥½ã‚€"},{t:"æ„Ÿè¦šçµ±åˆ", q:"ğŸ‘• ç‰¹å®šã®æ„Ÿè§¦ã‚’æ¥µç«¯ã«å«ŒãŒã£ãŸã‚Šå¤§å¥½ãã™ãã‚‹"},{t:"æ„Ÿè¦šçµ±åˆ", q:"ğŸŒ€ ãƒ–ãƒ©ãƒ³ã‚³ã‚„å›è»¢ãªã©ã®æ¿€ã—ã„æºã‚Œã‚’å¥½ã‚€"},{t:"æ„Ÿè¦šçµ±åˆ", q:"ğŸ§¸ ãã‚…ã£ã¨ã•ã‚Œã‚‹ã¨å®‰å¿ƒæ„Ÿã‚’å¾—ã‚„ã™ã„"},{t:"å®Ÿè¡Œæ©Ÿèƒ½", q:"â¸ï¸ æ¬¡ã®è¡Œå‹•ã¸ã®åˆ‡ã‚Šæ›¿ãˆã«æ™‚é–“ãŒã‹ã‹ã‚‹"},{t:"å®Ÿè¡Œæ©Ÿèƒ½", q:"ğŸ“ å¿˜ã‚Œç‰©ã‚„è½ã¨ã—ç‰©ãŒå¤šã„"},{t:"å®Ÿè¡Œæ©Ÿèƒ½", q:"â³ æ™‚é–“ã®æ„Ÿè¦šã‚’æ´ã‚€ã®ãŒè‹¦æ‰‹"},{t:"å®Ÿè¡Œæ©Ÿèƒ½", q:"ğŸ’ æº–å‚™ã®é †ç•ªãŒã‚ã‹ã‚‰ãªããªã‚‹"}];

function autoScroll(el) { const b = el.closest('.q-block').nextElementSibling; if (b && b.classList.contains('q-block')) setTimeout(() => b.scrollIntoView({ behavior: 'smooth', block: 'center' }), 300); }
function create5Scale(name) { return `<div class="radio-group">${['ã‚ˆã<br>ã‚ã¦ã¯ã¾ã‚‹','ã‚ã¦ã¯ã¾ã‚‹','ã‚ã‹ã‚‰<br>ãªã„','ã‚ã¾ã‚Š<br>ã‚ã¦ã¯ã¾ã‚‰ãªã„','ã‚ã¦ã¯ã¾<br>ã‚‰ãªã„'].map((l,i)=>`<label class="radio-label"><input type="radio" name="${name}" value="${4-i}" onclick="autoScroll(this)">${l}</label>`).join('')}</div>`; }

function setup() {
    [['mi', miData], ['ki', kiData], ['ka', kaData]].forEach(([id, data]) => {
        const target = document.getElementById(id+'-q');
        data.forEach((d,i)=> target.innerHTML += `<div class="q-block"><span class="q-text">${i+1}. ${d.q}</span>${create5Scale(id+i)}</div>`);
    });
}
setup();

let results = { mi:null, ki:null, ka:null };

function calcMI() {
    let scores = {}; miData.forEach((d,i) => scores[d.c] = (scores[d.c] || 0) + parseInt(document.querySelector(`input[name="mi${i}"]:checked`)?.value || 0));
    results.mi = scores; showMiChart(scores);
    const top = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
    const d = miDetails[top];
    document.getElementById('mi-res').innerHTML = `<h3>ğŸŒŸ ã€Œ${top}ã€ã«è¼ãæ‰èƒ½ã‚’æ„Ÿã˜ã¾ã™</h3><div class="detail-card"><strong>ã“ã®å­ã®ã‚®ãƒ•ãƒˆï¼š</strong>${d.èƒ½åŠ›}</div><div class="detail-card"><strong>å¿ƒãŒã‘ãŸã„é–¢ã‚ã‚Šï¼š</strong>${d.é–¢ã‚ã‚Š}</div><div class="detail-card"><strong>å¿œæ´ã—ã¦ãã‚Œã‚‹ã‚µãƒãƒ¼ã‚¿ãƒ¼ï¼š</strong>${d.é ¼ã‚‹äºº}</div><p style="font-size:0.8rem; color:#666;">â€»ã‚°ãƒ©ãƒ•ã¯ä»Šã®ãƒãƒ©ãƒ³ã‚¹ã§ã™ã€‚æˆé•·ã¨å…±ã«å½¢ã¯å¤‰ã‚ã£ã¦ã„ãã¾ã™ã€‚</p>`;
    document.getElementById('mi-res').style.display = 'block'; checkReady();
}

function showMiChart(scores) {
    const ctx = document.getElementById('miChart').getContext('2d');
    if(window.miRadar) window.miRadar.destroy();
    window.miRadar = new Chart(ctx, { type:'radar', data:{ labels:Object.keys(miDetails), datasets:[{ label:'ä»Šã®ãƒãƒ©ãƒ³ã‚¹', data: Object.keys(miDetails).map(l=>scores[l]||0), backgroundColor:'rgba(255,127,127,0.2)', borderColor: '#ff7f7f', borderWidth:3 }]}, options:{ scales:{ r:{ min:0, max:8, ticks:{ display:false }}} }});
}

function calcKi() {
    let scores = {}; kiData.forEach((d,i) => scores[d.t] = (scores[d.t] || 0) + parseInt(document.querySelector(`input[name="ki${i}"]:checked`)?.value || 0));
    const sorted = Object.keys(scores).sort((a,b) => scores[b] - scores[a]);
    const top1 = sorted[0]; const top2 = sorted[1];
    const isHybrid = (scores[top1] - scores[top2] <= 2);
    results.ki = { type: top1, type2: isHybrid ? top2 : null, detail: kiDetails[top1], detail2: isHybrid ? kiDetails[top2] : null };
    
    let resText = isHybrid ? `<h3>ğŸŒˆ ãŠå­ã•ã‚“ã¯ã€Œ${top1} Ã— ${top2}ã€ã®ç´ æ•µãªãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã§ã™</h3>` : `<h3>ğŸŒˆ ãŠå­ã•ã‚“ã¯ã€Œ${top1}ã‚¿ã‚¤ãƒ—ã€ã®ãƒ”ãƒ¥ã‚¢ãªè¼ãã‚’æŒã£ã¦ã„ã¾ã™</h3>`;
    resText += `<div class="detail-card"><strong>æœ¬èƒ½ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼š</strong>${results.ki.detail.ç¿»è¨³}${isHybrid ? ' ï¼† ' + results.ki.detail2.ç¿»è¨³ : ''}</div><div class="detail-card"><strong>è¦ªå­ã®ç¬‘é¡”ã‚’å®ˆã‚‹ãƒ’ãƒ³ãƒˆï¼š</strong>${results.ki.detail.å¯¾å¿œ}</div><p style="font-size:0.85rem;">ã‚ãŒã¾ã¾ã«è¦‹ãˆã‚‹ç¬é–“ã‚‚ã€å®Ÿã¯è„³ãŒä¸€ç”Ÿæ‡¸å‘½ã«è‡ªåˆ†ã‚’å®ˆã‚ã†ã¨ã—ã¦ã„ã‚‹ã‚µã‚¤ãƒ³ã§ã™ã€‚ãã®è±Šã‹ãªå€‹æ€§ã‚’ä¸€ç·’ã«é¢ç™½ãŒã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>`;
    document.getElementById('ki-res').innerHTML = resText;
    document.getElementById('ki-res').style.display = 'block'; checkReady();
}

function calcKa() {
    let scores = {}; kaData.forEach((d,i) => scores[d.t] = (scores[d.t] || 0) + parseInt(document.querySelector(`input[name="ka${i}"]:checked`)?.value || 0));
    const top = Object.keys(scores).reduce((a, b) => scores[a] > scores[b] ? a : b);
    results.ka = { type: top, detail: kaDetails[top] };
    document.getElementById('ka-res').innerHTML = `<h3>ğŸ  ç’°å¢ƒã‚’ã€Œ${top}ã€ã«æ•´ãˆã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ</h3><div class="detail-card"><strong>ä»Šã®ã€Œå›°ã£ãŸã€ã®èƒŒæ™¯ï¼š</strong>${kaDetails[top].è§£èª¬}</div><div class="detail-card"><strong>ä»Šæ—¥ã‹ã‚‰ã§ãã‚‹é­”æ³•ã®æ‰‹ç«‹ã¦ï¼š</strong>${kaDetails[top].æ‰‹ç«‹ã¦}</div><p style="font-size:0.85rem;">æ€§æ ¼ã‚’å¤‰ãˆã‚‹ã®ã¯å¤§å¤‰ã§ã™ãŒã€ç’°å¢ƒã‚’å°‘ã—æ•´ãˆã‚‹ã ã‘ã§ã€ãŠå­ã•ã‚“ã®ã‚¹ãƒˆãƒ¬ã‚¹ã¯åŠ‡çš„ã«æ¸›ã‚Šã€æœ¬æ¥ã®è‰¯ã•ãŒæº¢ã‚Œå‡ºã—ã¾ã™ã€‚</p>`;
    document.getElementById('ka-res').style.display = 'block'; checkReady();
}

function checkReady() { if([results.mi, results.ki, results.ka].filter(r => r !== null).length >= 2) document.getElementById('total-btn').disabled = false; }

function generateTotalDiagnosis() {
    const miTop = Object.keys(results.mi).reduce((a, b) => results.mi[a] > results.mi[b] ? a : b);
    const kiTitle = results.ki.type2 ? `${results.ki.type} Ã— ${results.ki.type2}` : results.ki.type;
    const honyakuText = results.ki.type2 ? `${results.ki.detail.ç¿»è¨³}ã¨ã€${results.ki.detail2.ç¿»è¨³}` : results.ki.detail.ç¿»è¨³;

    const summaryHtml = `
        ğŸŒ± <strong>å¼·ã¿ï¼š${miTop}çš„çŸ¥èƒ½</strong><br>${miDetails[miTop].èƒ½åŠ›}<br><br>
        ğŸ«‚ <strong>æ€§æ ¼ï¼š${kiTitle}ã‚¿ã‚¤ãƒ—</strong><br>${honyakuText}<br><br>
        ğŸ—ï¸ <strong>ç’°å¢ƒï¼š${results.ka.type}ã®ã‚µãƒãƒ¼ãƒˆ</strong><br>${results.ka.detail.æ‰‹ç«‹ã¦}
    `;
    const translationHtml = `
        ã€Œ${results.ki.detail.å›°ã‚Š}ã€ã¨ã„ã£ãŸè¡Œå‹•ã¯ã€è„³ãŒ<strong>ã€Œ${honyakuText}ã€</strong>ã¨ã„ã†ã‚µã‚¤ãƒ³ã‚’å¿…æ­»ã«å‡ºã—ã¦ã„ã‚‹è¨¼æ‹ ã§ã™ã€‚<br><br>
        å¤§äººãŒ<strong>${results.ka.detail.æ‰‹ç«‹ã¦}</strong>ã‚’ç”¨æ„ã—ã€<strong>ã€Œ${results.ki.detail.å¯¾å¿œ}ã€</strong>ã‚’å¿ƒãŒã‘ã‚‹ã“ã¨ã§ã€ãŠå­ã•ã‚“ã¯ã‚ˆã‚Šè‡ªåˆ†ã‚‰ã—ãè¼ã‘ã¾ã™ã€‚
    `;
    const messageHtml = `
        ã„ã¤ã‚‚ã€æœ¬å½“ã«ãŠç–²ã‚Œæ§˜ã§ã™ã€‚å®Œç’§ãªè¦ªã§ã‚ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä»Šæ—¥ã“ã†ã—ã¦ãƒ’ãƒ³ãƒˆã‚’æ¢ã—ãŸã“ã¨è‡ªä½“ãŒã€ãŠå­ã•ã‚“ã¸ã®æœ€é«˜ã®æ„›ã§ã™ã€‚ã‚¤ãƒ©ã‚¤ãƒ©ã—ãŸã‚‰ã€Œã‚ã€è„³ã®ã‚µã‚¤ãƒ³ã ï¼ã€ã¨æ€ã„å‡ºã—ã¦ã¿ã¦ãã ã•ã„ã€‚ç§ãŸã¡ã¯ã€é ‘å¼µã‚‹ã‚ãªãŸã®å‘³æ–¹ã§ã™ã€‚
    `;

    document.getElementById('total-content').innerHTML = `
        <div class="summary-box" style="border-left-color:var(--mi-color)">${summaryHtml}</div>
        <div class="translation-box">${translationHtml}</div>
        <div class="message-box">${messageHtml}</div>
    `;

    // éš ã—ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚¨ãƒªã‚¢ã«ã‚»ãƒƒãƒˆ
    document.getElementById('cap-summary').innerHTML = summaryHtml;
    document.getElementById('cap-translation').innerHTML = translationHtml;
    document.getElementById('cap-message').innerHTML = messageHtml;
}

function saveAsImage() {
    const area = document.getElementById('capture-container');
    html2canvas(area, { scale: 2 }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'å­ã©ã‚‚ã‚µãƒãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰.png';
        link.href = canvas.toDataURL();
        link.click();
    });
}

document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn, .tab-content').forEach(el => el.classList.remove('active'));
        btn.classList.add('active'); 
        document.getElementById(btn.dataset.tab).classList.add('active');
        if(btn.dataset.tab === 'total') generateTotalDiagnosis();
        window.scrollTo({top: 0, behavior: 'smooth'});
    });
});
</script>
</body>
</html>
